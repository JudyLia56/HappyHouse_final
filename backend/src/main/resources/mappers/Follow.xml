<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.happyhouse.mapper.FollowMapper">

	<insert id="follow" parameterType="com.ssafy.happyhouse.dto.FollowDto">
		insert into follow (from_userid, to_userid) 
		values ( #{from_userid}, #{to_userid})
	</insert>
	
	<insert id="check" parameterType="com.ssafy.happyhouse.dto.FollowDto">
		select if(count(*) = 1, 1, 0)
 		from follow
		where ( #{from_userid}, #{to_userid})
	</insert>
	
	<delete id="unfollow" parameterType="com.ssafy.happyhouse.dto.FollowDto">
		delete from follow
		where from_userid = #{from_userid}
		and to_userid = #{to_userid}
	</delete>
	
	<select id="follower" parameterType="string" resultType="com.ssafy.happyhouse.dto.MemberDto">
		SELECT from_userid,userid, username, userpwd, email, address, joindate
		from ssafy_member m , follow f
		WHERE m.userid = f.from_userid and f.to_userid = #{to_userid}
	</select>
	
	<select id="following" parameterType="string" resultType="com.ssafy.happyhouse.dto.MemberDto">
		SELECT to_userid, userid, username, userpwd, email, address, joindate
		from ssafy_member m , follow f
		WHERE m.userid = f.to_userid and f.from_userid = #{from_userid}
	</select>
	
	<select id="followerCount" parameterType="String" resultType="int">
		select count(from_userid)
		from follow
		where to_userid = #{userid};
	</select>
	
	<select id="followingCount" parameterType="String" resultType="int">
		select count(to_userid)
		from follow
		where from_userid = #{userid};
	</select>

</mapper>